!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Usync=e():t.Usync=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function n(){for(var t={},e=0,r=Object.keys(s);e<r.length;e++){t[r[e]+"Quene"]=[]}return t}var o,i=r(1);!function(t){t[t.READY=0]="READY",t[t.PENDING=1]="PENDING",t[t.FULFILLED=2]="FULFILLED",t[t.REJECTED=3]="REJECTED"}(o||(o={}));var s={appStart:1,taskStart:2,taskEnd:3,appEnd:4},f=function(){function t(t,e){this.vessel={},this.lifecycleList=n(),this.root=Array.isArray(t)?t:"string"==typeof t?this.setName(t)&&{}:"object"==typeof t?[t]:{},e=i.assign({},e),e.name&&this.setName(e.name),this.root.$name=this.__name__,this.defferd=[],this.index=-1,this.state=o.READY}return t.prototype.fulfilledBroadcast=function(){},Object.defineProperty(t.prototype,"currentDefferd",{get:function(){return this.defferd[this.index]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prevDefferd",{get:function(){return this.defferd[this.index-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextDefferd",{get:function(){return this.defferd[this.index+1]},enumerable:!0,configurable:!0}),t.prototype.setName=function(t){return this.__name__=t,this},Object.defineProperty(t.prototype,"name",{get:function(){return this.__name__},enumerable:!0,configurable:!0}),t.prototype.use=function(t){if(!Array.isArray(t))return this.defferd.push(t),1===this.defferd.length?(this.state=o.PENDING,this.index=0):this.defferd[this.defferd.length-2].__state__===o.FULFILLED&&this.then(),this;for(var e=0,r=t;e<r.length;e++){var n=r[e];this.use(n)}},t.prototype.then=function(){this.currentDefferd.startTime=(new Date).getTime();var e=[this.root].concat(this.done.bind(this));try{this.setRootProperty(),this.runHookByName("taskStart"),"function"==typeof this.currentDefferd?this.currentDefferd.apply(this,e):this.currentDefferd instanceof t&&(this.currentDefferd.fulfilledBroadcast=this.done.bind(this),this.currentDefferd.start())}catch(t){if(!this.catch)throw new Error(t);var r=[t].concat([this.root],this.done.bind(this));this.catch.apply(this,r)}},t.prototype.setRootProperty=function(){this.root.$current=this.currentDefferd,this.root.$prev=this.prevDefferd,this.root.$next=this.nextDefferd},t.prototype.done=function(){if(this.currentDefferd.__state__=o.FULFILLED,this.currentDefferd.endTime=(new Date).getTime(),this.setRootProperty(),this.runHookByName("taskEnd"),++this.index===this.defferd.length)return this.state=o.FULFILLED,this.defferd=[],this.index=-1,this.runHookByName("appEnd"),void("function"==typeof this.fulfilledBroadcast&&this.fulfilledBroadcast());void 0!==this.currentDefferd&&void 0===this.currentDefferd.__state__&&this.then()},t.prototype.start=function(){this.runHookByName("appStart"),this.startTime=(new Date).getTime(),this.then()},t.prototype.runHookByName=function(t){new Function("this.lifecycleList."+t+"Quene.forEach(start => start.call(this, this.root))\n        if (this.proto.lifecycleList) {\n            var "+t+"Quene = this.proto.lifecycleList."+t+"Quene\n            "+t+"Quene.forEach(start => start.call(this, this.root))\n        }").call(this)},Object.defineProperty(t.prototype,"proto",{get:function(){return Object.getPrototypeOf(this)},enumerable:!0,configurable:!0}),t.prototype.extend=function(t){for(var e=0,r=Object.keys(this.lifecycleList);e<r.length;e++){var n=r[e],o=n.replace("Quene","");t[o]&&this.lifecycleList[n].push(t[o])}},t.createApp=function(e){return new t(e)},t.extend=function(e){t.prototype.lifecycleList=n(),t.prototype.extend.call(t.prototype,e)},t}();t.exports=f},function(t,e,r){"use strict";function n(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var n=0;n<e.length;n++){var o=e[n];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.assign=n}])});
//# sourceMappingURL=Usync.min.js.map